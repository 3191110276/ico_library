[{"Body":{"ClassId":"workflow.CustomDataTypeDefinition","CompositeType":true,"Label":"Proxy Configuration","Name":"iks_proxy_config","ObjectType":"workflow.CustomDataTypeDefinition","ParameterSet":[{"Condition":"eq","ControlParameter":"use_proxy","EnableParameters":["httpproxyprotocol","httpproxyhostname","httpproxyport","httpproxyusername","httpproxypassword","httpsproxyprotocol","httpsproxyhostname","httpsproxyport","httpsproxyusername","httpsproxypassword","dockernoproxy"],"Name":"show_proxy_fields","ObjectType":"workflow.ParameterSet","Value":"true"}],"Properties":{"ObjectType":"workflow.CustomDataTypeProperties"},"SharedScope":"user","Tags":[{"Key":"category","Value":"Cisco Intersight Kubernetes"}],"TypeDefinition":[{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Determines if a proxy should be configured","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Use Proxy","Name":"use_proxy","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"boolean"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The protocol used for connecting to the HTTP proxy","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"HTTP Proxy Protocol","Name":"httpproxyprotocol","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[{"Label":"HTTP","ObjectType":"workflow.EnumEntry","Value":"http"},{"Label":"HTTPS","ObjectType":"workflow.EnumEntry","Value":"https"}],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"enum"}},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The hostname configured for the HTTP proxy","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"HTTP Proxy Hostname","Name":"httpproxyhostname","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"}},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The port configured for the HTTP Proxy","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"HTTP Proxy Port","Name":"httpproxyport","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"Max":65535,"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"integer"}},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The username used for connecting to the HTTP Proxy","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"HTTP Proxy Username","Name":"httpproxyusername","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"}},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The password used for connecting to the HTTP Proxy","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"HTTP Proxy Password","Name":"httpproxypassword","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Secure":true,"Type":"string"}},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The protocol used for connecting to the HTTPS Proxy","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"HTTPS Proxy Protocol","Name":"httpsproxyprotocol","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[{"Label":"HTTP","ObjectType":"workflow.EnumEntry","Value":"http"},{"Label":"HTTPS","ObjectType":"workflow.EnumEntry","Value":"https"}],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"enum"}},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The hostname configured for the HTTPS proxy","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"HTTPS Proxy Hostname","Name":"httpsproxyhostname","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"}},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The port configured for the HTTPS proxy","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"HTTPS Proxy Port","Name":"httpsproxyport","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"Max":65535,"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"integer"}},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The username used for connecting to the HTTPS Proxy","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"HTTPS Proxy Username","Name":"httpsproxyusername","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"}},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The port used for connecting to the HTTPS Proxy","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"HTTPS Proxy Password","Name":"httpsproxypassword","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Secure":true,"Type":"string"}},{"ArrayItemType":{"ObjectType":"workflow.PrimitiveArrayItem","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"}},"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"List of hosts that should not use the proxy server for connections","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"No Proxy","Max":1000,"Name":"dockernoproxy","ObjectType":"workflow.ArrayDataType"}]},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/CustomDataTypeDefinitions","Verb":"POST"},{"Body":{"ClassId":"workflow.TaskDefinition","DefaultVersion":true,"Description":"Delete Cisco Intersight Platform Managed Object","Label":"Delete Managed Object","Name":"DeleteManagedObject","ObjectType":"workflow.TaskDefinition","Properties":{"ExternalMeta":true,"InputDefinition":[{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The type of object that should be deleted","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"Dropdown"},"Label":"Object Type","Name":"objecttype","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[{"Label":"kubernetes/AddonPolicies","ObjectType":"workflow.EnumEntry","Value":"/api/v1/kubernetes/AddonPolicies"},{"Label":"kubernetes/ContainerRuntimePolicies","ObjectType":"workflow.EnumEntry","Value":"/api/v1/kubernetes/ContainerRuntimePolicies"},{"Label":"kubernetes/VersionPolicies","ObjectType":"workflow.EnumEntry","Value":"/api/v1/kubernetes/VersionPolicies"},{"Label":"kubernetes/NetworkPolicies","ObjectType":"workflow.EnumEntry","Value":"/api/v1/kubernetes/NetworkPolicies"},{"Label":"kubernetes/SysConfigPolicies","ObjectType":"workflow.EnumEntry","Value":"/api/v1/kubernetes/SysConfigPolicies"},{"Label":"kubernetes/NodeGroupProfiles","ObjectType":"workflow.EnumEntry","Value":"/api/v1/kubernetes/NodeGroupProfiles"},{"Label":"kubernetes/TrustedRegistriesPolicies","ObjectType":"workflow.EnumEntry","Value":"/api/v1/kubernetes/TrustedRegistriesPolicies"},{"Label":"kubernetes/VirtualMachineInfraConfigPolicies","ObjectType":"workflow.EnumEntry","Value":"/api/v1/kubernetes/VirtualMachineInfraConfigPolicies"},{"Label":"kubernetes/VirtualMachineInstanceTypes","ObjectType":"workflow.EnumEntry","Value":"/api/v1/kubernetes/VirtualMachineInstanceTypes"}],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"enum"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The Moid of the object that should be deleted","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Moid","Name":"moid","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true}],"ObjectType":"workflow.Properties","OutputDefinition":[],"RetryCount":5,"RetryDelay":20,"RetryPolicy":"Fixed","SupportStatus":"Supported","Timeout":600,"TimeoutPolicy":"Timeout"},"RollbackTasks":[],"SharedScope":"user","Tags":[{"Key":"category","Value":"Cisco Intersight Platform"}],"Version":1},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/TaskDefinitions","Verb":"POST"},{"Body":{"ClassId":"workflow.TaskDefinition","DefaultVersion":true,"Description":"Create Cisco Intersight Kubernetes Container Runtime Policy","Label":"Create Container Runtime Policy","Name":"CreateContainerRuntimePolicy","ObjectType":"workflow.TaskDefinition","Properties":{"ExternalMeta":true,"InputDefinition":[{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The name of the Container Runtime policy that will be created","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Name","Name":"name","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"Max":1000,"Min":1,"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"CIDR range for the default bridge network","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Bridge IP","Name":"dockerdaemonbridgeip","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"}},{"Default":{"ObjectType":"workflow.DefaultValue"},"DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Proxy Configuration","Name":"proxy_config","ObjectType":"workflow.CustomDataType","Properties":{"CatalogMoid":"user","CustomDataTypeName":"iks_proxy_config","ObjectType":"workflow.CustomDataProperty"},"Required":true}],"ObjectType":"workflow.Properties","OutputDefinition":[{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The Moid of the created Container Runtime Policy","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Moid","Name":"moid","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true}],"RetryCount":5,"RetryDelay":60,"RetryPolicy":"Fixed","SupportStatus":"Supported","Timeout":600,"TimeoutPolicy":"Timeout"},"RollbackTasks":[{"CatalogMoid":"user","Description":"Delete Cisco Intersight Platform Managed Object","InputParameters":{"moid":"${task.output.moid}","objecttype":"/api/v1/kubernetes/ContainerRuntimePolicies"},"Name":"DeleteManagedObject","ObjectType":"workflow.RollbackTask","Version":1}],"SecurePropAccess":true,"SharedScope":"user","Tags":[{"Key":"category","Value":"Cisco Intersight Kubernetes"}],"Version":1},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/TaskDefinitions","Verb":"POST"},{"Body":{"Batch":[{"ContentType":"json","Description":"Delete Cisco Intersight Platform Managed Object","EndpointRequestType":"Internal","Label":"Delete Cisco Intersight Platform Managed Object","Method":"DELETE","Name":"DeleteCiscoIntersightPlatformManagedObject","ObjectType":"workflow.WebApi","Outcomes":[],"Protocol":"https","ResponseSpec":{"ErrorParameters":[],"ObjectType":"content.Grammar","Parameters":[],"Types":[]},"TargetType":"Local","Url":"{{.global.task.input.objecttype}}/{{.global.task.input.moid}}"}],"ClassId":"workflow.BatchApiExecutor","Constraints":{"ObjectType":"workflow.TaskConstraints"},"Description":"Delete Cisco Intersight Platform Managed Object","Name":"Delete Managed Object","ObjectType":"workflow.BatchApiExecutor","Output":{},"SharedScope":"user","TaskDefinition":{"ObjectType":"workflow.TaskDefinition","Selector":"Name eq \"DeleteManagedObject\" and Version eq 1"}},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/BatchApiExecutors","Verb":"POST"},{"Body":{"Batch":[{"Body":"{\r\n    \"Name\":\"{{.global.task.input.name}}\",\r\n    {{if eq .global.task.input.proxy_config.use_proxy true}}\r\n    {{if index .global.task.input.proxy_config \"httpproxyhostname\"}}\r\n    \"DockerHttpProxy\":{\r\n        {{with $y := .global.task.input.proxy_config.httpproxyprotocol}}\r\n        \"Protocol\":\"{{$y}}\",\r\n        {{end}}\r\n        {{with $y := .global.task.input.proxy_config.httpproxyport}}\r\n        \"Port\":{{$y}},\r\n        {{end}}\r\n        {{with $y := .global.task.input.proxy_config.httpproxyusername}}\r\n        \"Username\":\"{{$y}}\",\r\n        {{end}}\r\n        {{with $y := .global.task.input.proxy_config.httpproxypassword}}\r\n        \"Password\":\"{{$y}}\",\r\n        {{end}}\r\n        \"Hostname\":\"{{.global.task.input.proxy_config.httpproxyhostname}}\"\r\n    },\r\n    {{end}}\r\n    {{if index .global.task.input.proxy_config \"httpsproxyhostname\"}}\r\n    \"DockerHttpsProxy\":{\r\n        {{with $y := .global.task.input.proxy_config.httpsproxyprotocol}}\r\n        \"Protocol\":\"{{$y}}\",\r\n        {{end}}\r\n        {{with $y := .global.task.input.proxy_config.httpsproxyport}}\r\n        \"Port\":{{$y}},\r\n        {{end}}\r\n        {{with $y := .global.task.input.proxy_config.httpsproxyusername}}\r\n        \"Username\":\"{{$y}}\",\r\n        {{end}}\r\n        {{with $y := .global.task.input.proxy_config.httpsproxypassword}}\r\n        \"Password\":\"{{$y}}\",\r\n        {{end}}\r\n        \"Hostname\":\"{{.global.task.input.proxy_config.httpsproxyhostname}}\"\r\n    },\r\n    {{end}}\r\n    {{with $x := .global.task.input.proxy_config.dockernoproxy}}\r\n    \"DockerNoProxy\":[{{ range $index, $element := $x}}{{if $index}},{{end}}\"{{$element}}\"{{end}}],\r\n    {{else}}\r\n    \"DockerHttpProxy\":{}\r\n    {{end}}\r\n    {{end}}\r\n    {{with $x := .global.task.input.dockerdaemonbridgeip}}\r\n    \"DockerBridgeNetworkCidr\":\"{{$x}}\",\r\n    {{end}}\r\n    \"Organization\":{\r\n        \"ObjectType\":\"organization.Organization\",\r\n        \"Moid\":\"{{.security.OrganizationMoid}}\"\r\n    }\r\n}","ContentType":"json","Description":"Create Cisco Intersight Kubernetes Container Runtime Policy","EndpointRequestType":"Internal","Label":"Create Cisco Intersight Kubernetes Container Runtime Policy","Method":"POST","Name":"CreateCiscoIntersightKubernetesContainerRuntimePolicy","ObjectType":"workflow.WebApi","Outcomes":[{"Condition":".local.response.HttpStatusCode ne 200","Message":"Failed to create Container Runtime Policy","Name":"HTTP Status Code Check","ObjectType":"workflow.Outcome","Type":"Error"}],"Protocol":"https","ResponseSpec":{"ErrorParameters":[],"ObjectType":"content.Grammar","Parameters":[{"AcceptSingleValue":false,"ComplexType":"","ItemType":"simple","Name":"moid","ObjectType":"content.Parameter","Path":"$.Moid","Secure":false,"Type":"string"}],"Types":[]},"TargetType":"Local","Url":"/api/v1/kubernetes/ContainerRuntimePolicies"}],"ClassId":"workflow.BatchApiExecutor","Constraints":{"ObjectType":"workflow.TaskConstraints"},"Description":"Create Cisco Intersight Kubernetes Container Runtime Policy","Name":"Create Container Runtime Policy","ObjectType":"workflow.BatchApiExecutor","Output":{"moid":"{{.global.CreateCiscoIntersightKubernetesContainerRuntimePolicy.output.moid}}"},"SharedScope":"user","TaskDefinition":{"ObjectType":"workflow.TaskDefinition","Selector":"Name eq \"CreateContainerRuntimePolicy\" and Version eq 1"}},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/BatchApiExecutors","Verb":"POST"}]
[{"Body":{"ClassId":"workflow.TaskDefinition","DefaultVersion":true,"Description":"Delete Cisco Intersight Platform Managed Object","Label":"Delete Managed Object","Name":"DeleteManagedObject","ObjectType":"workflow.TaskDefinition","Properties":{"ExternalMeta":true,"InputDefinition":[{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The type of object that should be deleted","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"Dropdown"},"Label":"Object Type","Name":"objecttype","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[{"Label":"kubernetes/AddonPolicies","ObjectType":"workflow.EnumEntry","Value":"/api/v1/kubernetes/AddonPolicies"},{"Label":"kubernetes/ContainerRuntimePolicies","ObjectType":"workflow.EnumEntry","Value":"/api/v1/kubernetes/ContainerRuntimePolicies"},{"Label":"kubernetes/VersionPolicies","ObjectType":"workflow.EnumEntry","Value":"/api/v1/kubernetes/VersionPolicies"},{"Label":"kubernetes/NetworkPolicies","ObjectType":"workflow.EnumEntry","Value":"/api/v1/kubernetes/NetworkPolicies"},{"Label":"kubernetes/SysConfigPolicies","ObjectType":"workflow.EnumEntry","Value":"/api/v1/kubernetes/SysConfigPolicies"},{"Label":"kubernetes/NodeGroupProfiles","ObjectType":"workflow.EnumEntry","Value":"/api/v1/kubernetes/NodeGroupProfiles"},{"Label":"kubernetes/TrustedRegistriesPolicies","ObjectType":"workflow.EnumEntry","Value":"/api/v1/kubernetes/TrustedRegistriesPolicies"},{"Label":"kubernetes/VirtualMachineInfraConfigPolicies","ObjectType":"workflow.EnumEntry","Value":"/api/v1/kubernetes/VirtualMachineInfraConfigPolicies"},{"Label":"kubernetes/VirtualMachineInstanceTypes","ObjectType":"workflow.EnumEntry","Value":"/api/v1/kubernetes/VirtualMachineInstanceTypes"}],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"enum"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The Moid of the object that should be deleted","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Moid","Name":"moid","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true}],"ObjectType":"workflow.Properties","OutputDefinition":[],"RetryCount":5,"RetryDelay":20,"RetryPolicy":"Fixed","SupportStatus":"Supported","Timeout":600,"TimeoutPolicy":"Timeout"},"RollbackTasks":[],"SharedScope":"user","Tags":[{"Key":"category","Value":"Cisco Intersight Platform"}],"Version":1},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/TaskDefinitions","Verb":"POST"},{"Body":{"ClassId":"workflow.TaskDefinition","DefaultVersion":true,"Description":"Create Cisco Intersight Kubernetes NodeGroup Profile","Label":"Create NodeGroup Profile","Name":"CreateNodeGroupProfile","ObjectType":"workflow.TaskDefinition","Properties":{"ExternalMeta":true,"InputDefinition":[{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The name of the NodeGroup Profile to be created","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Name","Name":"name","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"Max":1000,"Min":1,"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The node type of the NodeGroup Profile to be created","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"Dropdown"},"Label":"Node Type","Name":"nodetype","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[{"Label":"Control Plane","ObjectType":"workflow.EnumEntry","Value":"ControlPlane"},{"Label":"Worker","ObjectType":"workflow.EnumEntry","Value":"Worker"},{"Label":"Control Plane + Worker","ObjectType":"workflow.EnumEntry","Value":"ControlPlaneWorker"}],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"enum"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The desired size of the NodeGroup Profile to be created","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Desired Size","Name":"desiredsize","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"Max":128,"Min":1,"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"integer"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The minimum size of the NodeGroup Profile to be created","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Minimum Size","Name":"minsize","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"Max":128,"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The maximum size of the NodeGroup Profile to be created","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Maximum Size","Name":"maxsize","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"Max":128,"Min":1,"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The Kubernetes version of the NodeGroup Profile to be created","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Kubernetes Version","Name":"k8sversion","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[{"DisplayAttributes":["Name","Moid"],"ObjectType":"workflow.MoReferenceProperty","Selector":"/api/v1/kubernetes/VersionPolicies","SelectorProperty":{"Method":"GET","ObjectType":"workflow.SelectorProperty"},"ValueAttribute":"Moid"}],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The IP pool of the NodeGroup Profile to be created","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"IP Pool","Name":"ippool","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[{"DisplayAttributes":["Name","Moid"],"ObjectType":"workflow.MoReferenceProperty","Selector":"/api/v1/ippool/Pools","SelectorProperty":{"Method":"GET","ObjectType":"workflow.SelectorProperty"},"ValueAttribute":"Moid"}],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The Cluster Profile to which this NodeGroup profile will be associated","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Cluster Profile","Name":"clusterprofile","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[{"DisplayAttributes":["Name","Moid"],"ObjectType":"workflow.MoReferenceProperty","Selector":"/api/v1/kubernetes/ClusterProfiles","SelectorProperty":{"Method":"GET","ObjectType":"workflow.SelectorProperty"},"ValueAttribute":"Moid"}],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The Infra Config Policy that should be used for this profile","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Infra Config Policy","Name":"infraconfigpolicy","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[{"DisplayAttributes":["Name","Moid"],"ObjectType":"workflow.MoReferenceProperty","Selector":"/api/v1/kubernetes/VirtualMachineInfraConfigPolicy","SelectorProperty":{"Method":"GET","ObjectType":"workflow.SelectorProperty"},"ValueAttribute":"Moid"}],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The instance type that should be used for this profile","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Instance Type","Name":"instancetype","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[{"DisplayAttributes":["Name","Moid"],"ObjectType":"workflow.MoReferenceProperty","Selector":"/api/v1/kubernetes/VirtualMachineInstanceType","SelectorProperty":{"Method":"GET","ObjectType":"workflow.SelectorProperty"},"ValueAttribute":"Moid"}],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true}],"ObjectType":"workflow.Properties","OutputDefinition":[{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The Moid of the created NodeGroup Profile","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Moid","Name":"moid","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true}],"RetryCount":5,"RetryDelay":60,"RetryPolicy":"Fixed","SupportStatus":"Supported","Timeout":600,"TimeoutPolicy":"Timeout"},"RollbackTasks":[{"CatalogMoid":"user","Description":"Delete Cisco Intersight Platform Managed Object","InputParameters":{"moid":"${task.output.moid}","objecttype":"/api/v1/kubernetes/NodeGroupProfiles"},"Name":"DeleteManagedObject","ObjectType":"workflow.RollbackTask","Version":1}],"SharedScope":"user","Tags":[{"Key":"category","Value":"Cisco Intersight Kubernetes"}],"Version":1},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/TaskDefinitions","Verb":"POST"},{"Body":{"Batch":[{"ContentType":"json","Description":"Delete Cisco Intersight Platform Managed Object","EndpointRequestType":"Internal","Label":"Delete Cisco Intersight Platform Managed Object","Method":"DELETE","Name":"DeleteCiscoIntersightPlatformManagedObject","ObjectType":"workflow.WebApi","Outcomes":[],"Protocol":"https","ResponseSpec":{"ErrorParameters":[],"ObjectType":"content.Grammar","Parameters":[],"Types":[]},"TargetType":"Local","Url":"{{.global.task.input.objecttype}}/{{.global.task.input.moid}}"}],"ClassId":"workflow.BatchApiExecutor","Constraints":{"ObjectType":"workflow.TaskConstraints"},"Description":"Delete Cisco Intersight Platform Managed Object","Name":"Delete Managed Object","ObjectType":"workflow.BatchApiExecutor","Output":{},"SharedScope":"user","TaskDefinition":{"ObjectType":"workflow.TaskDefinition","Selector":"Name eq \"DeleteManagedObject\" and Version eq 1"}},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/BatchApiExecutors","Verb":"POST"},{"Body":{"Batch":[{"Body":"{\r\n  \"Name\": \"{{.global.task.input.name}}\",\r\n  \"NodeType\": \"{{.global.task.input.nodetype}}\",\r\n  \"Desiredsize\": {{.global.task.input.desiredsize}},\r\n  \"Minsize\": {{.global.task.input.minsize}},\r\n  \"Maxsize\": {{.global.task.input.maxsize}},\r\n  \"KubernetesVersion\": {\r\n    \"ClassId\": \"mo.MoRef\",\r\n    \"Moid\": \"{{.global.task.input.k8sversion}}\",\r\n    \"ObjectType\": \"kubernetes.VersionPolicy\",\r\n    \"link\": \"https://www.intersight.com/api/v1/kubernetes/VersionPolicies/{{.global.task.input.k8sversion}}\"\r\n  },\r\n  \"IpPools\": [\r\n    {\r\n      \"ClassId\": \"mo.MoRef\",\r\n      \"Moid\": \"{{.global.task.input.ippool}}\",\r\n      \"ObjectType\": \"ippool.Pool\",\r\n      \"link\": \"https://www.intersight.com/api/v1/ippool/Pools/{{.global.task.input.ippool}}\"\r\n    }\r\n  ],\r\n  \"ClusterProfile\": {\r\n    \"ClassId\": \"mo.MoRef\",\r\n    \"Moid\": \"{{.global.task.input.clusterprofile}}\",\r\n    \"ObjectType\": \"kubernetes.ClusterProfile\",\r\n    \"link\": \"https://www.intersight.com/api/v1/kubernetes/ClusterProfiles/{{.global.task.input.clusterprofile}}\"\r\n  },\r\n  \"ClassId\": \"kubernetes.NodeGroupProfile\",\r\n  \"ObjectType\": \"kubernetes.NodeGroupProfile\",\r\n  \"Type\": \"instance\"\r\n}","ContentType":"json","Description":"Create Cisco Intersight Kubernetes NodeGroup Profile","EndpointRequestType":"Internal","Label":"Create Cisco Intersight Kubernetes NodeGroup Profile","Method":"POST","Name":"CreateCiscoIntersightKubernetesNodeGroupProfile","ObjectType":"workflow.WebApi","Outcomes":[{"Condition":".local.response.HttpStatusCode ne 200","Message":"Failed to create NodeGroup Profile","Name":"HTTP Status Code Check","ObjectType":"workflow.Outcome","Type":"Error"}],"Protocol":"https","ResponseSpec":{"ErrorParameters":[],"ObjectType":"content.Grammar","Parameters":[{"AcceptSingleValue":false,"ComplexType":"","ItemType":"simple","Name":"moid","ObjectType":"content.Parameter","Path":"$.Moid","Secure":false,"Type":"string"}],"Types":[]},"TargetType":"Local","Url":"/api/v1/kubernetes/NodeGroupProfiles"},{"Body":"{\r\n  \"ClassId\": \"kubernetes.VirtualMachineInfrastructureProvider\",\r\n  \"InfraConfigPolicy\": {\r\n    \"ClassId\": \"mo.MoRef\",\r\n    \"Moid\": \"{{.global.task.input.infraconfigpolicy}}\",\r\n    \"ObjectType\": \"kubernetes.VirtualMachineInfraConfigPolicy\",\r\n    \"link\": \"https://www.intersight.com/api/v1/kubernetes/VirtualMachineInfraConfigPolicies/{{.global.task.input.infraconfigpolicy}}\"\r\n  },\r\n  \"InstanceType\": {\r\n    \"ClassId\": \"mo.MoRef\",\r\n    \"Moid\": \"{{.global.task.input.instancetype}}\",\r\n    \"ObjectType\": \"kubernetes.VirtualMachineInstanceType\",\r\n    \"link\": \"https://www.intersight.com/api/v1/kubernetes/VirtualMachineInstanceTypes/{{.global.task.input.instancetype}}\"\r\n  },\r\n  \"Name\": \"{{.global.task.input.name}}\",\r\n  \"NodeGroup\": {\r\n    \"ClassId\": \"mo.MoRef\",\r\n    \"Moid\": \"{{.global.CreateCiscoIntersightKubernetesNodeGroupProfile.output.moid}}\",\r\n    \"ObjectType\": \"kubernetes.NodeGroupProfile\",\r\n    \"link\": \"https://www.intersight.com/api/v1/kubernetes/NodeGroupProfiles/{{.global.CreateCiscoIntersightKubernetesNodeGroupProfile.output.moid}}\"\r\n  },\r\n  \"ObjectType\": \"kubernetes.VirtualMachineInfrastructureProvider\"\r\n}","ContentType":"json","Description":"Create Cisco Intersight Kubernetes Virtual Machine Infrastructure Provider","EndpointRequestType":"Internal","Label":"Create Cisco Intersight Kubernetes Virtual Machine Infrastructure Provider","Method":"POST","Name":"CreateCiscoIntersightKubernetesVirtualMachineInfrastructureProvider","ObjectType":"workflow.WebApi","Outcomes":[],"Protocol":"https","ResponseSpec":{"ErrorParameters":[],"ObjectType":"content.Grammar","Parameters":[{"AcceptSingleValue":false,"ComplexType":"","ItemType":"simple","Name":"moid","ObjectType":"content.Parameter","Path":"$.Moid","Secure":false,"Type":"string"}],"Types":[]},"TargetType":"Local","Url":"/api/v1/kubernetes/VirtualMachineInfrastructureProviders"}],"ClassId":"workflow.BatchApiExecutor","Constraints":{"ObjectType":"workflow.TaskConstraints"},"Description":"Create Cisco Intersight Kubernetes NodeGroup Profile","Name":"Create NodeGroup Profile","ObjectType":"workflow.BatchApiExecutor","Output":{"moid":"{{.global.CreateCiscoIntersightKubernetesNodeGroupProfile.output.moid}}"},"SharedScope":"user","TaskDefinition":{"ObjectType":"workflow.TaskDefinition","Selector":"Name eq \"CreateNodeGroupProfile\" and Version eq 1"}},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/BatchApiExecutors","Verb":"POST"}]
